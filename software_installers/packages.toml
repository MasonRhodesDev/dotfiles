# ============================================================================
# SOFTWARE PACKAGE REGISTRY
# ============================================================================
# Centralized package definitions organized by profile type
# Sections: common (all machines), work (work only), personal (personal only)

# ============================================================================
# COMMON PACKAGES (All Machines - Personal & Work)
# ============================================================================

[common.build_tools]
description = "Build tools and compilers"
install_level = "system"
priority = 1
  [common.build_tools.fedora]
  packages = ["make", "gcc", "gcc-c++", "automake", "autoconf", "pkg-config", "dnf-plugins-core"]

  [common.build_tools.arch]
  packages = ["base-devel"]

[common.core_utils]
description = "Essential system utilities"
install_level = "system"
priority = 2
  [common.core_utils.fedora]
  packages = ["vim", "curl", "git", "jq", "thunar", "solaar", "wireplumber", "NetworkManager", "go", "gcc-go", "keychain", "powerline-fonts", "fira-code-fonts", "google-roboto-fonts", "google-roboto-condensed-fonts", "google-roboto-slab-fonts", "piper", "headsetcontrol", "direnv"]
  repos = ["copr:solopasha/hyprland"]
  min_version = "40"

  [common.core_utils.arch]
  packages = ["vim", "curl", "git", "jq", "thunar", "wireplumber", "networkmanager", "go", "keychain", "direnv"]
  aur_packages = ["solaar", "ttf-fira-code", "piper", "headsetcontrol"]

[common.terminal]
description = "Terminal emulators and shell tools"
install_level = "system"
priority = 2
  [common.terminal.fedora]
  packages = ["wezterm", "tmux", "fish"]

  [common.terminal.arch]
  packages = ["tmux", "fish"]
  aur_packages = ["wezterm-git"]

[common.shell_tools]
description = "Shell prompt and environment tools"
install_level = "user"
priority = 3
  [common.shell_tools.fedora]
  packages = []
  install_command = "curl -s https://ohmyposh.dev/install.sh | bash -s"
  verify_command = "oh-my-posh --version"

  [common.shell_tools.arch]
  aur_packages = ["oh-my-posh-bin"]

[common.node_tooling]
description = "Node.js and JavaScript development"
install_level = "user"
priority = 4
depends_on = ["core_utils"]
  [common.node_tooling.fedora]
  packages = ["cargo"]
  cargo_packages = ["fnm"]
  install_command = "curl -fsSL https://bun.sh/install | BUN_INSTALL_SKIP_SHELL_UPDATE=1 bash"
  verify_command = "bun --version"

  [common.node_tooling.arch]
  aur_packages = ["fnm-bin", "bun-bin"]

[common.hyprland]
description = "Hyprland compositor ecosystem"
install_level = "system"
priority = 5
depends_on = ["core_utils"]
  [common.hyprland.fedora]
  packages = ["hyprcursor", "hyprcursor-devel", "hypridle", "hyprland", "hyprland-devel", "hyprland-protocols-devel", "hyprlang", "hyprlang-devel", "hyprlock", "hyprpicker", "hyprutils", "hyprutils-devel", "hyprwayland-scanner-devel", "xdg-desktop-portal-hyprland", "wofi", "waybar", "dunst", "pavucontrol", "swaybg", "wl-clipboard", "grim", "slurp"]
  repos = ["copr:solopasha/hyprland", "copr:heus-sueh/packages"]
  repo_priorities = { "copr:heus-sueh/packages" = 200 }
  cargo_packages = ["matugen"]
  min_version = "40"

  [common.hyprland.arch]
  packages = ["wl-clipboard", "grim", "slurp", "pavucontrol", "dunst", "waybar"]
  aur_packages = ["hyprland-git", "hyprlock-git", "hypridle-git", "hyprpicker-git", "hyprcursor-git", "hyprutils-git", "hyprlang-git", "hyprwayland-scanner-git", "xdg-desktop-portal-hyprland-git", "wofi-git", "swaybg-git", "matugen-git", "swaync-git", "swayosd-git"]

[common.browsers]
install_level = "system"
priority = 6
description = "Web browsers"
  [common.browsers.fedora]
  packages = ["vivaldi-stable"]
  default_browser = "vivaldi-stable.desktop"
  profiles = ["personal"]
  extensions = ["bitwarden"]

  [common.browsers.arch]
  aur_packages = ["vivaldi"]
  default_browser = "vivaldi-stable.desktop"
  profiles = ["personal"]
  extensions = ["bitwarden"]

[common.ide]
install_level = "user"
priority = 7
description = "Integrated development environments"
  [common.ide.fedora]
  packages = []
  install_command = "curl -LO https://github.com/neovim/neovim/releases/download/v0.11.5/nvim-linux-x86_64.tar.gz && tar xzf nvim-linux-x86_64.tar.gz && rm -rf ~/.local/nvim-linux-x86_64 && mv nvim-linux-x86_64 ~/.local/ && mkdir -p ~/.local/bin && ln -sf ~/.local/nvim-linux-x86_64/bin/nvim ~/.local/bin/nvim && rm nvim-linux-x86_64.tar.gz"
  verify_command = "~/.local/bin/nvim --version | head -1 | grep 'v0.11.5'"

  [common.ide.arch]
  packages = []
  install_command = "curl -LO https://github.com/neovim/neovim/releases/download/v0.11.5/nvim-linux-x86_64.tar.gz && tar xzf nvim-linux-x86_64.tar.gz && rm -rf ~/.local/nvim-linux-x86_64 && mv nvim-linux-x86_64 ~/.local/ && mkdir -p ~/.local/bin && ln -sf ~/.local/nvim-linux-x86_64/bin/nvim ~/.local/bin/nvim && rm nvim-linux-x86_64.tar.gz"
  verify_command = "~/.local/bin/nvim --version | head -1 | grep 'v0.11.5'"

[common.astal]
install_level = "system"
priority = 8
description = "Astal library for widget toolkits"
  [common.astal.fedora]
  packages = ["meson", "vala", "valadoc", "gobject-introspection-devel", "wayland-protocols-devel", "gtk3-devel", "gtk-layer-shell-devel", "gtk4-devel", "gtk4-layer-shell-devel"]

  [[common.astal.fedora.git_repos]]
  url = "https://github.com/aylur/astal.git"
  install_dir = "~/git_installers/astal/astal"
  update_strategy = "pull"
  build_steps = [
    "cd lib/astal/io && rm -rf build && meson setup build && sudo meson install -C build",
    "cd ../../gtk3 && rm -rf build && meson setup build && sudo meson install -C build",
    "cd ../gtk4 && rm -rf build && meson setup build && sudo meson install -C build"
  ]

  [common.astal.arch]
  aur_packages = ["libastal-meta"]

[common.gimp]
description = "Image editing and manipulation"
install_level = "system"
priority = 9
  [common.gimp.fedora]
  packages = ["gimp"]

  [common.gimp.arch]
  packages = ["gimp"]

[common.python_dev]
description = "Python development environment"
install_level = "system"
priority = 9
disabled = true
  [common.python_dev.fedora]
  packages = ["python3", "python3-pip", "python3-virtualenv", "pipx"]
  
  [common.python_dev.arch]
  packages = ["python", "python-pip", "python-virtualenv", "python-pipx"]

[common.rust_dev]
description = "Rust development toolchain"
install_level = "system"
priority = 10
optional = true
  [common.rust_dev.fedora]
  packages = []

  [common.rust_dev.arch]
  packages = []

[common.nix]
description = "Nix package manager"
install_level = "system"
priority = 11
  [common.nix.fedora]
  packages = []
  install_command = "sh <(curl -L https://nixos.org/nix/install) --daemon"
  verify_command = "nix --version"

  [common.nix.arch]
  packages = ["nix"]

# ============================================================================
# WORK-ONLY PACKAGES
# ============================================================================

[work.docker]
install_level = "system"
priority = 11
conflicts = ["podman", "moby-engine", "docker-cli"]
description = "Container runtime and orchestration"
depends_on = ["build_tools"]
pre_install_command = "sudo dnf remove -y moby-engine docker-cli 2>/dev/null || true"
  [work.docker.fedora]
  packages = ["docker-ce", "docker-ce-cli", "containerd.io", "docker-buildx-plugin", "docker-compose-plugin"]
  repos = ["https://download.docker.com/linux/fedora/docker-ce.repo"]
  services = ["docker", "containerd"]
  user_groups = ["docker"]
  
  [work.docker.arch]
  packages = ["docker", "docker-compose"]
  services = ["docker", "containerd"]
  user_groups = ["docker"]

[work.mongodb]
install_level = "system"
priority = 12
description = "MongoDB database and tools"
version = "8.0"
  [work.mongodb.fedora]
  packages = ["mongodb-org", "mongodb-mongosh"]
  repos = ["https://repo.mongodb.org/yum/redhat/9/mongodb-org/8.0/x86_64/"]
  repo_config = """
[mongodb-org-8.0]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/9/mongodb-org/8.0/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://pgp.mongodb.com/server-8.0.asc
"""
  services = ["mongod"]
  post_install_command = "mongosh --eval \"rs.initiate({_id: 'rs0', members: [{_id: 0, host: 'localhost:27017'}]})\""
  post_install_check = "mongosh --quiet --eval 'rs.status()'"

  [work.mongodb.arch]
  aur_packages = ["mongodb-bin", "mongodb-tools-bin", "mongodb-compass"]
  services = ["mongodb"]
  post_install_command = "mongosh --eval \"rs.initiate({_id: 'rs0', members: [{_id: 0, host: 'localhost:27017'}]})\""
  post_install_check = "mongosh --quiet --eval 'rs.status()'"

[work.aws_tools]
description = "AWS development and deployment tools"
install_level = "user"
priority = 13
  [work.aws_tools.fedora]
  packages = ["awscli2"]
  
  [work.aws_tools.arch]
  packages = ["aws-cli-v2"]
  aur_packages = ["aws-session-manager-plugin"]

[work.vpn_tools]
description = "VPN and secure connectivity"
install_level = "system"
priority = 14
  [work.vpn_tools.fedora]
  packages = ["pritunl-client-electron"]
  repos = ["https://repo.pritunl.com/stable/yum/fedora/41/"]
  repo_config = """
[pritunl]
name=Pritunl Stable Repository
baseurl=https://repo.pritunl.com/stable/yum/fedora/41/
gpgcheck=1
enabled=1
gpgkey=https://raw.githubusercontent.com/pritunl/pritunl-client-electron/master/release_signing.asc
"""

  [work.vpn_tools.arch]
  aur_packages = ["pritunl-client-electron"]

[work.slack]
description = "Team communication"
install_level = "system"
priority = 18
  [work.slack.fedora]
  packages = ["slack"]
  
  [work.slack.arch]
  aur_packages = ["slack-desktop"]

[work.zoom]
description = "Video conferencing"
install_level = "system"
priority = 19
  [work.zoom.fedora]
  flatpak = ["us.zoom.Zoom"]

  [work.zoom.arch]
  aur_packages = ["zoom"]

[work.postman]
description = "API development and testing"
install_level = "user"
priority = 20
  [work.postman.fedora]
  flatpak = ["com.getpostman.Postman"]

  [work.postman.arch]
  aur_packages = ["postman-bin"]

[work.browsers]
description = "Work browser profile configuration"
install_level = "system"
priority = 21
  [work.browsers.fedora]
  profiles = ["work", "personal"]
  extensions = ["bitwarden"]

  [work.browsers.arch]
  profiles = ["work", "personal"]
  extensions = ["bitwarden"]

# ============================================================================
# PERSONAL-ONLY PACKAGES
# ============================================================================

[personal.gaming]
install_level = "system"
priority = 21
description = "Gaming platforms and tools"
  [personal.gaming.fedora]
  packages = ["steam", "lutris", "gamemode"]
  
  [personal.gaming.arch]
  packages = ["steam", "lutris", "gamemode"]
  multilib = true

[personal.media_creation]
install_level = "system"
priority = 22
description = "Audio/video editing and creation"
  [personal.media_creation.fedora]
  packages = ["kdenlive", "audacity", "inkscape", "blender", "obs-studio"]

  [personal.media_creation.arch]
  packages = ["kdenlive", "audacity", "inkscape", "blender", "obs-studio"]

[personal.social]
install_level = "user"
priority = 24
description = "Communication and social apps"
  [personal.social.fedora]
  packages = []
  flatpak = ["com.discordapp.Discord"]

  [personal.social.arch]
  aur_packages = ["discord"]


[personal.emulators]
description = "PS2 game emulation"
install_level = "user"
priority = 27
optional = true
  [personal.emulators.fedora]
  flatpak = ["net.pcsx2.PCSX2"]

  [personal.emulators.arch]
  packages = ["pcsx2"]
