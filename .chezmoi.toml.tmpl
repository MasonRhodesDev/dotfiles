# .chezmoi.toml
[edit]
    command="nvim"
[merge]
    command="nvim"
    args = ["-d"]
[git]
    autoCommit = true
    autoPush = true
[data]
    work_machine = "mason-work"
    wallpaper = {{ if eq .chezmoi.hostname "mason-work" }}"/home/mason/Pictures/forrest.png"{{ else }}"/home/mason/Pictures/landscape.png"{{ end }}
    is_work = {{ if eq .chezmoi.hostname "mason-work" }}true{{ else }}false{{ end }}

[data.paths]
    config = "/home/mason/.config/hypr"
    scripts = "/home/mason/scripts"

# Profile configuration
[data.profile]
    type = {{ if eq .chezmoi.hostname "mason-work" }}"work"{{ else }}"personal"{{ end }}

# System tracking - updated on each chezmoi apply
[data.system]
    hostname = "{{ .chezmoi.hostname }}"
    os = "{{ .chezmoi.os }}"
    os_release_id = "{{ .chezmoi.osRelease.id }}"
    os_release_version = "{{ if hasKey .chezmoi.osRelease "versionID" }}{{ .chezmoi.osRelease.versionID }}{{ else }}rolling{{ end }}"
    arch = "{{ .chezmoi.arch }}"
    last_updated = "{{ now | date "2006-01-02T15:04:05Z07:00" }}"
    
# System manifest tracking file location
[data.tracking]
    manifest_file = ".system_manifest.json"

# Bitwarden Integration via rbw with Agent Model and Caching
[data.bitwarden]
    available = {{ if lookPath "rbw" }}true{{ else }}false{{ end }}
    source = {{ $bwIdentity := dict }}{{ if lookPath "rbw" }}{{ $bwJson := output "sh" "-c" "~/.local/bin/rbw-fetch-identity 2>/dev/null || echo '{}'" | trim }}{{ if ne $bwJson "{}" }}{{ $bwIdentity = $bwJson | fromJson }}{{ if and (hasKey $bwIdentity "name") (ne (get $bwIdentity "name") "") }}"bitwarden"{{ else }}"hardcoded"{{ end }}{{ else }}"hardcoded"{{ end }}{{ else }}"hardcoded"{{ end }}

[data.identity]
    name = {{ $bwIdentity := dict }}{{ if lookPath "rbw" }}{{ $bwJson := output "sh" "-c" "~/.local/bin/rbw-fetch-identity 2>/dev/null || echo '{}'" | trim }}{{ if ne $bwJson "{}" }}{{ $bwIdentity = $bwJson | fromJson }}{{ end }}{{ end }}{{ if and (hasKey $bwIdentity "name") (ne (get $bwIdentity "name") "") }}{{ get $bwIdentity "name" | quote }}{{ else }}"User Name"{{ end }}
    email_work = {{ $bwIdentity := dict }}{{ if lookPath "rbw" }}{{ $bwJson := output "sh" "-c" "~/.local/bin/rbw-fetch-identity 2>/dev/null || echo '{}'" | trim }}{{ if ne $bwJson "{}" }}{{ $bwIdentity = $bwJson | fromJson }}{{ end }}{{ end }}{{ if and (hasKey $bwIdentity "email_work") (ne (get $bwIdentity "email_work") "") }}{{ get $bwIdentity "email_work" | quote }}{{ else }}"work@example.com"{{ end }}
    email_personal = {{ $bwIdentity := dict }}{{ if lookPath "rbw" }}{{ $bwJson := output "sh" "-c" "~/.local/bin/rbw-fetch-identity 2>/dev/null || echo '{}'" | trim }}{{ if ne $bwJson "{}" }}{{ $bwIdentity = $bwJson | fromJson }}{{ end }}{{ end }}{{ if and (hasKey $bwIdentity "email_personal") (ne (get $bwIdentity "email_personal") "") }}{{ get $bwIdentity "email_personal" | quote }}{{ else }}"user@example.com"{{ end }}
    email = {{ $bwIdentity := dict }}{{ if lookPath "rbw" }}{{ $bwJson := output "sh" "-c" "~/.local/bin/rbw-fetch-identity 2>/dev/null || echo '{}'" | trim }}{{ if ne $bwJson "{}" }}{{ $bwIdentity = $bwJson | fromJson }}{{ end }}{{ end }}{{ if .is_work }}{{ if and (hasKey $bwIdentity "email_work") (ne (get $bwIdentity "email_work") "") }}{{ get $bwIdentity "email_work" | quote }}{{ else }}"work@example.com"{{ end }}{{ else }}{{ if and (hasKey $bwIdentity "email_personal") (ne (get $bwIdentity "email_personal") "") }}{{ get $bwIdentity "email_personal" | quote }}{{ else }}"user@example.com"{{ end }}{{ end }}
